@model Sector_13_Welfare_Society___Digital_Management_System.Models.MemberDashboardViewModel

@{
    ViewData["Title"] = "Member Dashboard";
    Layout = "~/Views/Shared/_DashboardLayout.cshtml";
}

<style>
    .premium-gradient {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
    }
    
    .premium-card {
        background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
        border: none;
        border-radius: 20px;
        box-shadow: 0 20px 40px rgba(0,0,0,0.1);
        transition: all 0.3s ease;
        overflow: hidden;
    }
    
    .premium-card:hover {
        transform: translateY(-10px);
        box-shadow: 0 30px 60px rgba(0,0,0,0.15);
    }
    
    .stat-card {
        background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
        border: none;
        border-radius: 20px;
        box-shadow: 0 15px 35px rgba(0,0,0,0.08);
        transition: all 0.3s ease;
        overflow: hidden;
        position: relative;
    }
    
    .stat-card:hover {
        transform: translateY(-5px);
        box-shadow: 0 25px 50px rgba(0,0,0,0.12);
    }
    
    .stat-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 4px;
        background: linear-gradient(90deg, #667eea, #764ba2);
    }
    
    .welcome-section {
        background: linear-gradient(135deg, #667eea 0%, #764ba2 100%);
        border-radius: 15px;
        padding: 20px;
        margin-bottom: 15px;
        color: white;
        position: relative;
        overflow: hidden;
    }
    
    .welcome-section::before {
        content: '';
        position: absolute;
        top: -50%;
        right: -50%;
        width: 200%;
        height: 200%;
        background: radial-gradient(circle, rgba(255,255,255,0.1) 0%, transparent 70%);
        animation: float 6s ease-in-out infinite;
    }
    
    @@keyframes float {
        0%, 100% { transform: translateY(0px) rotate(0deg); }
        50% { transform: translateY(-20px) rotate(180deg); }
    }
    
    .premium-btn {
        border-radius: 8px;
        padding: 8px 16px;
        font-weight: 600;
        font-size: 0.85rem;
        transition: all 0.3s ease;
        border: none;
        position: relative;
        overflow: hidden;
    }
    
    .premium-btn::before {
        content: '';
        position: absolute;
        top: 0;
        left: -100%;
        width: 100%;
        height: 100%;
        background: linear-gradient(90deg, transparent, rgba(255,255,255,0.2), transparent);
        transition: left 0.5s;
    }
    
    .premium-btn:hover::before {
        left: 100%;
    }
    
    .premium-btn:hover {
        transform: translateY(-2px);
        box-shadow: 0 10px 25px rgba(0,0,0,0.2);
    }
    
    .booking-card {
        background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
        border: none;
        border-radius: 12px;
        box-shadow: 0 8px 20px rgba(0,0,0,0.08);
        transition: all 0.3s ease;
        overflow: hidden;
        margin-bottom: 15px;
        position: relative;
    }
    
    .booking-card:hover {
        transform: translateY(-8px);
        box-shadow: 0 25px 50px rgba(0,0,0,0.15);
    }
    
    .booking-card::before {
        content: '';
        position: absolute;
        top: 0;
        left: 0;
        right: 0;
        height: 5px;
        background: linear-gradient(90deg, #667eea, #764ba2);
    }
    
    .status-badge {
        border-radius: 25px;
        padding: 8px 20px;
        font-weight: 600;
        text-transform: uppercase;
        letter-spacing: 1px;
        font-size: 0.8rem;
    }
    
    .quick-action-btn {
        background: linear-gradient(145deg, #ffffff 0%, #f8f9ff 100%);
        border: none;
        border-radius: 12px;
        padding: 15px 10px;
        text-align: center;
        transition: all 0.3s ease;
        box-shadow: 0 6px 15px rgba(0,0,0,0.08);
        position: relative;
        overflow: hidden;
    }
    
    .quick-action-btn:hover {
        transform: translateY(-10px);
        box-shadow: 0 20px 40px rgba(0,0,0,0.15);
    }
    
    .quick-action-btn i {
        font-size: 1.8rem;
        margin-bottom: 8px;
        background: linear-gradient(135deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .fade-in {
        animation: fadeIn 0.8s ease-in;
    }
    
    @@keyframes fadeIn {
        from { opacity: 0; transform: translateY(30px); }
        to { opacity: 1; transform: translateY(0); }
    }
    
    .slide-in-left {
        animation: slideInLeft 0.8s ease-out;
    }
    
    @@keyframes slideInLeft {
        from { opacity: 0; transform: translateX(-50px); }
        to { opacity: 1; transform: translateX(0); }
    }
    
    .slide-in-right {
        animation: slideInRight 0.8s ease-out;
    }
    
    @@keyframes slideInRight {
        from { opacity: 0; transform: translateX(50px); }
        to { opacity: 1; transform: translateX(0); }
    }
    
    .pulse {
        animation: pulse 2s infinite;
    }
    
    @@keyframes pulse {
        0% { transform: scale(1); }
        50% { transform: scale(1.05); }
        100% { transform: scale(1); }
    }
    
    .no-bookings {
        background: linear-gradient(145deg, #f8f9ff 0%, #e8f2ff 100%);
        border-radius: 25px;
        padding: 60px 40px;
        text-align: center;
        border: 2px dashed #667eea;
    }
    
    .no-bookings i {
        font-size: 5rem;
        background: linear-gradient(135deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
        margin-bottom: 20px;
    }
    
    .alert-premium {
        border: none;
        border-radius: 15px;
        padding: 20px;
        box-shadow: 0 10px 25px rgba(0,0,0,0.1);
        border-left: 5px solid;
    }
    
    .alert-success-premium {
        background: linear-gradient(145deg, #d4edda 0%, #c3e6cb 100%);
        border-left-color: #28a745;
    }
    
    .stat-icon {
        width: 40px;
        height: 40px;
        border-radius: 50%;
        display: flex;
        align-items: center;
        justify-content: center;
        font-size: 1rem;
        color: white;
        margin-bottom: 8px;
    }
    
    .stat-number {
        font-size: 1.8rem;
        font-weight: 700;
        background: linear-gradient(135deg, #667eea, #764ba2);
        -webkit-background-clip: text;
        -webkit-text-fill-color: transparent;
        background-clip: text;
    }
    
    .stat-label {
        font-size: 0.9rem;
        font-weight: 600;
        color: #6c757d;
        text-transform: uppercase;
        letter-spacing: 1px;
    }
    
    @@media (max-width: 768px) {
        .welcome-section {
            padding: 15px;
            text-align: center;
        }
        
        .premium-btn {
            padding: 6px 12px;
            font-size: 0.8rem;
        }
        
        .quick-action-btn {
            padding: 12px 8px;
            margin-bottom: 10px;
        }
        
        .stat-card {
            margin-bottom: 15px;
        }
        
        .booking-card .card-body {
            padding: 15px !important;
        }
        
        .stat-icon {
            width: 30px;
            height: 30px;
            font-size: 0.8rem;
        }
        
        .stat-number {
            font-size: 1.4rem;
        }
    }
</style>

<div class="container-fluid py-2">
    <!-- Welcome Section -->
    <div class="welcome-section fade-in">
        <div class="row align-items-center">
            <div class="col-lg-8">
                <h2 class="h4 fw-bold mb-2">
                    Welcome back, <span class="text-warning">@Model.User.Name!</span>
                </h2>
               </\div>
                <p class="mb-3">
                    Manage your bookings, track payments, and stay updated with your service requests.
                </p>
                
            </div>
            <div class="col-lg-4 text-center">
                <i class="fas fa-user-circle" style="font-size: 4rem; opacity: 0.3;"></i>
            </div>
        </div>
    </div>
    <!-- Quick Actions -->
    <div class="row mb-3">
        <div class="col-12 mb-2">
            <h3 class="h5 fw-bold text-dark">
                <i class="fas fa-bolt me-2" style="background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                Quick Actions
            </h3>
                </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <a href="@Url.Action("Index", "Booking")" class="quick-action-btn d-block text-decoration-none">
                <i class="fas fa-plus"></i>
                <h6 class="fw-bold mb-1">Create New Booking</h6>
                <small class="text-muted">Book a new service</small>
                            </a>
                        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <a href="@Url.Action("Orders", "MemberDashboard")" class="quick-action-btn d-block text-decoration-none">
                <i class="fas fa-shopping-bag"></i>
                <h6 class="fw-bold mb-1">View My Orders</h6>
                <small class="text-muted">Track your bookings</small>
                            </a>
                        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <a href="@Url.Action("PaymentHistory", "MemberDashboard")" class="quick-action-btn d-block text-decoration-none">
                <i class="fas fa-history"></i>
                <h6 class="fw-bold mb-1">Payment History</h6>
                <small class="text-muted">View payment records</small>
                            </a>
                        </div>
        
        <div class="col-lg-3 col-md-6 mb-3">
            <a href="@Url.Action("Invoices", "MemberDashboard")" class="quick-action-btn d-block text-decoration-none">
                <i class="fas fa-file-invoice"></i>
                <h6 class="fw-bold mb-1">My Invoices</h6>
                <small class="text-muted">Download invoices</small>
            </a>
        </div>
    </div>
</div>
    <!-- Booking Success Alert -->
    @if (TempData["BookingSuccess"] != null)
    {
        <div class="row mb-4 slide-in-left">
            <div class="col-12">
                <div class="alert alert-success-premium alert-dismissible fade show alert-premium" role="alert">
                    <div class="d-flex align-items-center">
                        <div class="stat-icon" style="background: linear-gradient(135deg, #28a745, #20c997); margin-right: 20px;">
                            <i class="fas fa-check-circle"></i>
                        </div>
                        <div class="flex-grow-1">
                            <h5 class="alert-heading mb-2 fw-bold">ðŸŽ‰ Booking Created Successfully!</h5>
                            <p class="mb-0 fs-5">@TempData["BookingSuccess"]</p>
                        </div>
                        <button type="button" class="btn-close btn-close-white" data-bs-dismiss="alert" aria-label="Close"></button>
                    </div>
                </div>
            </div>
        </div>
    }

    <!-- Current Bookings -->
    @if (Model.RecentBookings != null && Model.RecentBookings.Any())
    {
        <div class="row mb-3">
            <div class="col-12">
                <h3 class="h5 mb-3 fw-bold text-dark">
                    <i class="fas fa-calendar-check me-2" style="background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                    Recent Bookings
                </h3>
            </div>
        </div>
        
        @foreach (var booking in Model.RecentBookings.Take(2))
        {
            <div class="row mb-2 slide-in-right">
                <div class="col-12">
                    <div class="booking-card">
                        <div class="card-body p-3">
                            <div class="row align-items-center">
                                <div class="col-lg-8">
                                    <div class="d-flex align-items-center mb-2">
                                        <div class="stat-icon me-2" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                                            <i class="fas fa-clipboard-check"></i>
                                        </div>
                                        <div>
                                            <h6 class="mb-1 fw-bold text-dark">Booking #@booking.BookingNumber</h6>
                                            <small class="text-muted">@(booking.BookingItems?.FirstOrDefault()?.ServiceName ?? "Service Booking")</small>
                                        </div>
                        </div>
                                    
                            <div class="row">
                                <div class="col-md-6">
                                            <small class="d-flex align-items-center mb-1">
                                                <i class="fas fa-cog me-1 text-primary"></i>
                                                <span class="fw-semibold me-1">Service:</span>
                                                <span>@(booking.BookingItems?.FirstOrDefault()?.ServiceName ?? "Service Booking")</span>
                                            </small>
                                            <small class="d-flex align-items-center mb-1">
                                                <i class="fas fa-tag me-1 text-info"></i>
                                                <span class="fw-semibold me-1">Type:</span>
                                                <span>@(booking.BookingItems?.FirstOrDefault()?.ServiceType ?? "N/A")</span>
                                            </small>
                                        </div>
                                        <div class="col-md-6">
                                            <small class="d-flex align-items-center mb-1">
                                                <i class="fas fa-calendar me-1 text-success"></i>
                                                <span class="fw-semibold me-1">Date:</span>
                                                <span>@booking.BookingDate.ToString("MMM dd, yyyy")</span>
                                            </small>
                                            <small class="d-flex align-items-center mb-1">
                                                <i class="fas fa-dollar-sign me-1 text-warning"></i>
                                                <span class="fw-semibold me-1">Amount:</span>
                                                <span class="fw-bold text-success">$@booking.TotalAmount.ToString("F2")</span>
                                            </small>
                                        </div>
                                    </div>
                                </div>
                                
                                <div class="col-lg-4 text-lg-end text-center mt-2 mt-lg-0">
                                    <div class="mb-2">
                                        @{
                                            var statusClass = booking.PaymentStatus == "Pending" ? "warning" : 
                                                           booking.PaymentStatus == "Completed" ? "success" : 
                                                           booking.BookingStatus == "Processing" ? "primary" : 
                                                           booking.BookingStatus == "Completed" ? "success" : 
                                                           booking.BookingStatus == "Cancelled" ? "danger" : "secondary";
                                        }
                                        <span class="status-badge bg-@statusClass text-white">
                                            @(booking.PaymentStatus == "Pending" ? "Pending Payment" : 
                                              booking.PaymentStatus == "Completed" ? "Paid" : 
                                              booking.BookingStatus ?? "Pending")
                                        </span>
                                    </div>
                                    
                                    @if (booking.PaymentStatus == "Pending")
                                    {
                                        @* <a href="@Url.Action("ProcessPayment", "Booking", new { id = booking.Id })" class="btn btn-success btn-sm premium-btn"> *@
                                           <a> <i class="fas fa-credit-card me-1"></i>Upcomming !!
                                        </a>
                                    }
                                    else if (booking.PaymentStatus == "Completed")
                                    {
                                        <div class="alert alert-info mb-0 py-2 px-3 border-0" style="background: linear-gradient(145deg, #d1ecf1, #bee5eb); font-size: 0.8rem;">
                                            <i class="fas fa-clock me-1"></i>Payment received. Processing will begin shortly.
                                        </div>
                                    }
                                    else if (booking.BookingStatus == "Processing")
                                    {
                                        <div class="alert alert-primary mb-0 py-2 px-3 border-0" style="background: linear-gradient(145deg, #cce5ff, #b3d9ff); font-size: 0.8rem;">
                                            <i class="fas fa-cogs me-1"></i>Your booking is being processed.
                                        </div>
                                    }
                                    else if (booking.BookingStatus == "Completed")
                                    {
                                        <div class="alert alert-success mb-0 py-2 px-3 border-0" style="background: linear-gradient(145deg, #d4edda, #c3e6cb); font-size: 0.8rem;">
                                            <i class="fas fa-check-circle me-1"></i>Booking completed successfully!
                                        </div>
                                    }
                                    else if (booking.BookingStatus == "Cancelled")
                                    {
                                        <div class="alert alert-danger mb-0 py-2 px-3 border-0" style="background: linear-gradient(145deg, #f8d7da, #f5c6cb); font-size: 0.8rem;">
                                            <i class="fas fa-times-circle me-1"></i>Booking has been cancelled.
                                        </div>
                                    }
                                </div>
                            </div>
                        </div>
                    </div>
                </div>
            </div>
        }
        
        @if (Model.RecentBookings.Count > 2)
        {
            <div class="row mb-3">
                <div class="col-12 text-center">
                    <a href="@Url.Action("Orders", "MemberDashboard")" class="btn btn-outline-primary btn-sm">
                        <i class="fas fa-eye me-1"></i>View All Bookings (@Model.RecentBookings.Count)
                    </a>
                </div>
            </div>
        }
    }
    else
    {
        <div class="row mb-3">
            <div class="col-12">
                <div class="no-bookings fade-in" style="padding: 30px 20px;">
                    <i class="fas fa-calendar-plus" style="font-size: 3rem;"></i>
                    <h4 class="fw-bold mb-2" style="color: #667eea;">No Active Bookings</h4>
                    <p class="mb-3 text-muted">You don't have any active bookings at the moment. Start by creating your first booking!</p>
                    <a href="@Url.Action("Index", "Booking")" class="btn btn-primary premium-btn">
                        <i class="fas fa-plus me-1"></i>Create New Booking
                    </a>
                </div>
            </div>
        </div>
    }

    <!-- Statistics Cards -->
    <div class="row mb-3">
        <div class="col-12 mb-2">
            <h3 class="h5 fw-bold text-dark">
                <i class="fas fa-chart-bar me-2" style="background: linear-gradient(135deg, #667eea, #764ba2); -webkit-background-clip: text; -webkit-text-fill-color: transparent; background-clip: text;"></i>
                Dashboard Overview
            </h3>
                            </div>
        
        <div class="col-xl-3 col-md-6 mb-3">
            <div class="stat-card fade-in">
                <div class="card-body p-3 text-center">
                    <div class="stat-icon mx-auto" style="background: linear-gradient(135deg, #667eea, #764ba2);">
                        <i class="fas fa-calendar-check"></i>
                    </div>
                    <div class="stat-number">@(Model.RecentBookings?.Count ?? 0)</div>
                    <div class="stat-label">Total Bookings</div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="stat-card fade-in" style="animation-delay: 0.2s;">
                <div class="card-body p-3 text-center">
                    <div class="stat-icon mx-auto" style="background: linear-gradient(135deg, #f093fb, #f5576c);">
                        <i class="fas fa-credit-card"></i>
                    </div>
                    <div class="stat-number">@(Model.RecentBookings?.Count(b => b.PaymentStatus == "Pending") ?? 0)</div>
                    <div class="stat-label">Pending Payment</div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="stat-card fade-in" style="animation-delay: 0.4s;">
                <div class="card-body p-3 text-center">
                    <div class="stat-icon mx-auto" style="background: linear-gradient(135deg, #4facfe, #00f2fe);">
                        <i class="fas fa-check-circle"></i>
                    </div>
                    <div class="stat-number">@(Model.RecentBookings?.Count(b => b.BookingStatus == "Completed") ?? 0)</div>
                    <div class="stat-label">Completed Bookings</div>
                </div>
            </div>
        </div>

        <div class="col-xl-3 col-md-6 mb-3">
            <div class="stat-card fade-in" style="animation-delay: 0.6s;">
                <div class="card-body p-3 text-center">
                    <div class="stat-icon mx-auto" style="background: linear-gradient(135deg, #43e97b, #38f9d7);">
                        <i class="fas fa-times-circle"></i>
                    </div>
                    <div class="stat-number">@(Model.RecentBookings?.Count(b => b.BookingStatus == "Cancelled") ?? 0)</div>
                    <div class="stat-label">Cancelled Bookings</div>
                </div>
            </div>
        </div>
    </div>



@section Scripts {
    <script>
        // Auto-refresh dashboard every 30 seconds for booking status updates
        setTimeout(function() {
            location.reload();
        }, 30000);
        
        // Add smooth scroll animations
        document.addEventListener('DOMContentLoaded', function() {
            // Animate elements on scroll
            const observerOptions = {
                threshold: 0.1,
                rootMargin: '0px 0px -50px 0px'
            };
            
            const observer = new IntersectionObserver(function(entries) {
                entries.forEach(entry => {
                    if (entry.isIntersecting) {
                        entry.target.style.opacity = '1';
                        entry.target.style.transform = 'translateY(0)';
                    }
                });
            }, observerOptions);
            
            // Observe all animated elements
            document.querySelectorAll('.fade-in, .slide-in-left, .slide-in-right').forEach(el => {
                el.style.opacity = '0';
                el.style.transform = 'translateY(30px)';
                el.style.transition = 'all 0.8s ease-out';
                observer.observe(el);
            });
            
            // Add hover effects to cards
            document.querySelectorAll('.stat-card, .booking-card, .quick-action-btn').forEach(card => {
                card.addEventListener('mouseenter', function() {
                    this.style.transform = 'translateY(-10px) scale(1.02)';
                });
                
                card.addEventListener('mouseleave', function() {
                    this.style.transform = 'translateY(0) scale(1)';
                });
            });
            
            // Add click ripple effect to buttons
            document.querySelectorAll('.premium-btn, .quick-action-btn').forEach(btn => {
                btn.addEventListener('click', function(e) {
                    const ripple = document.createElement('span');
                    const rect = this.getBoundingClientRect();
                    const size = Math.max(rect.width, rect.height);
                    const x = e.clientX - rect.left - size / 2;
                    const y = e.clientY - rect.top - size / 2;
                    
                    ripple.style.width = ripple.style.height = size + 'px';
                    ripple.style.left = x + 'px';
                    ripple.style.top = y + 'px';
                    ripple.classList.add('ripple');
                    
                    this.appendChild(ripple);
                    
                    setTimeout(() => {
                        ripple.remove();
                    }, 600);
                });
            });
        });
        
        // Add ripple effect CSS
        const style = document.createElement('style');
        style.textContent = `
            .ripple {
                position: absolute;
                border-radius: 50%;
                background: rgba(255, 255, 255, 0.6);
                transform: scale(0);
                animation: ripple-animation 0.6s linear;
                pointer-events: none;
            }
            
            @@keyframes ripple-animation {
                to {
                    transform: scale(4);
                    opacity: 0;
                }
            }
            
            .premium-btn, .quick-action-btn {
                position: relative;
                overflow: hidden;
            }
        `;
        document.head.appendChild(style);
    </script>
}